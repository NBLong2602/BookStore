@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_LayoutHome.cshtml";
}
@using X.PagedList.Mvc.Core
@using X.PagedList.Web.Common;
@model X.PagedList.IPagedList<Book>

@foreach (var item in Model)
{
    <div class="col-lg-3 col-md-6 col-sm-12 pb-1">
        <div class="card product-item border-0 mb-4">
            <div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0">
                <img class="img-fluid w-100" src="/img/product-1.jpg" alt="Thumnail">
            </div>
            <div class="card-body border-left border-right text-center p-0 pt-4 pb-3">
                <h6 class="text-truncate mb-3">@item.BookName</h6>
                <div class="d-flex justify-content-center">
                    <h6>@item.Price VND</h6><h6 class="text-muted ml-2"></h6>
                </div>
            </div>
            <div class="card-footer d-flex justify-content-between bg-light border">
                <a asp-controller="Product" asp-action="ProductDetail" asp-route-productId="@item.Isbn" class="btn btn-sm text-dark p-0"><i class="fas fa-eye text-primary mr-1"></i>View Detail</a>
                <a data-id="@item.Isbn" class="ajax-add-to-cart btn btn-sm text-dark p-0"><i class="fas fa-shopping-cart text-primary mr-1"></i>Add To Cart</a>
            </div>
        </div>
    </div>
}
<!-- Pagination Start -->
<div class="col-12 pb-1">
    <nav aria-label="Page navigation">
        @Html.PagedListPager(Model, page => Url.Action("Index", new { page = page }),
        new PagedListRenderOptions
        {
        LiElementClasses = new string[] { "page-item" },
        UlElementClasses = new string[] { "pagination", "justify-content-center", "mb-3" },
        PageClasses = new string[] { "page-link" },
        })
    </nav>
</div>
<!-- Pagination End -->
@section Scripts{
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script>
        $(document).ready(function () {
            $(".ajax-add-to-cart").click(function () {
                $.ajax({
                    url: "/Cart/AddToCart",
                    data: {
                        productId: $(this).data("id"),
                        quantity: 1,
                        type: "ajax"
                    },
                    success: function (data) {
                        console.log(data);
                        Swal.fire({
                            icon: 'success',
                            title: 'Thêm giỏ hàng thành công',
                            showConfirmButton: false,
                            timer: 2500
                        }),
                            $("#cart_count").html(data.quantity);
                    },
                    error: function () {
                        Swal.fire({
                            icon: 'error',
                            title: 'Thêm giỏ hàng thất bại',
                            text: 'Vui lòng thử lại',
                            showConfirmButton: false,
                            timer: 2500
                        });
                    }
                });
            });
        });
    </script>
}
